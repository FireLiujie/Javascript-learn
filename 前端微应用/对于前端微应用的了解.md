## 概念

微前端是一种类似于微服务的架构，它将微服务的理念应用于浏览器端，即将单页面前端应用由单一的单体应用转变为多个小型前端应用聚合为一的应用。各个前端应用还可以独立开发、独立部署。同时，它们也可以在共享组件的同时进行并行开发-这些组件可以通过 NPM 或者 GitTag、Git Submodule 来管理

### 为什么需要微前端

1、遗留系统迁移。解决遗留系统，才是人们采用微前端方案最重要的原因
2、聚合前端应用。微服务架构，可以解耦后端服务间依赖。而微前端，则关注于聚合前端应用
3、热闹驱动开发。新的技术，既然很热闹，那么就学吧

### 微前端的好处

1、应用自治。只需要遵循统一的接口规范或者框架，以便于系统集成到一起，相互之间是不存在依赖关系的
2、单一职责。每个前端应用可以只关注于自己所需要完成的功能。
3、技术栈无关。你可以使用 Angluar 的同时，又可以使用 React 和 Vue。

### 微前端的缺点

1、应用的拆分基础依赖于基础设施的构建，一旦大量应用依赖于同一基础设施，那么维护变成了一个挑战
2、拆分的粒度越小，便意味着架构变得复杂、维护成本变高
3、技术栈一旦多样化，便意味着技术栈混乱

### 架构模式

基座模式。通过一个主应用，来管理其他应用。设计难度小，方便实践，但是通用度低。
自组织模式。应用之间是平等的，不存在相互管理的模式。设计难度大，不方便实施，但是通用度高。

不论何种方式，都需要提供一个查找应用的机制，在微前端中称为服务的注册表模式。和微服务架构相似，不论哪种微前端方式，也都需要一个应用注册表的服务，它可以是一个固定值的配置文件，如 JSON 文件，又或者是一个可动态更新的配置，又或者是一种动态的服务。它主要做这么一些内容：
1、应用发现。让主应用可以寻找到其它应用
2、应用注册。即提供新的微前端应用，向应用注册表注册的功能
3、第三方应用注册。即让第三方应用，可以接入到系统中
4、访问权限等相关配置

应用在部署的时候，便可以在注册表服务中注册。如果是基于注册表来管理应用，那么使用基座模式来开发比较方便

### 设计理念

需要重点关注的内容：
1、中心化：应用注册表。这个应用注册表拥有每个应用及对应的入口。在前端领域里，入口的直接表现形式可以是路由，又或者对应的应用映射
2、标识化应用。我们需要一个标识符来标识不同的应用，以便于在安装、卸载的时候，能寻找到指定的应用。一个简单的模式，就是通过康威定律来命名应用
3、应用生命周期管理
4、高内聚，低耦合

### 生命周期

前端微架构与后端微架构的最大不同之处，也在于此---生命周期。微前端应用作为一个客户端应用，每个应用都拥有自己的生命周期：
1、Load，决定加载哪个应用，并绑定生命周期
2、bootstrap，获取静态资源
3、Mount，安装应用，如创建 DOM 节点
4、Unload，删除应用的生命周期
5、Unmount，卸载应用，如删除 DOM 节点、取消事件绑定

这部分的内容事实上，也就是微前端的一个难点所在，如何以合适的方式来加载应用--毕竟每个前端框架都各自不同，其所需要的加载方式也是不同的。当我们决定支持多个框架的时候，便需要在这一部分进行更细致的研究

## 如何拆分？

### 技术方式

从技术实践上，微前端架构可以采用以下的几种方式进行
1、路由分发式。通过 HTTP 服务器的反向代理功能，来将请求路由到对应的应用上
2、前端微服务化。在不同的框架之上设计通讯、加载机制，以在一个页面内加载对应的应用
3、微应用。通过软件工程的方式，在部署构建环境中，组合多个独立应用成一个单体应用
4、微件化。开发一个新的构建系统，将部分业务功能构建成一个独立的 chunk 代码，使用时只需要远程加载即可
5、前端容器化。通过 iFrame 作为容器，来容纳其它前端应用
6、应用组件化。借助于 Web Components 技术，来构建跨框架的前端应用

#### 前端微服务化

前端微服务化，是微服务架构在前端的实施，每个前端应用都是完全独立（技术栈、开发、部署、构建独立）、自主运行的，最后通过模块化的方式组合出完成的前端应用。
采用这种方式意味着，一个页面同时存在二个及以上的前端应用在运行。而路由分发式方案，则是一个页面只有一个唯一应用

### 业务拆分

与微服务类似，要划分不同的前端边界，不是一件容易的事。就当前而言，以下几种方式是常见的划分微前端的方式：
1、按照业务拆分
2、按照权限拆分
3、按照变更的频率拆分
4、按照组织结构拆分。利用康威定律来进一步拆分前端应用
5、跟随后端微服务划分。实践证明，DDD 与事件风暴是一种颇为有效的后端微前端拆分模式，对于前端来说，它也颇有有效---直接跟踪后端服务
