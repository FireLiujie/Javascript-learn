<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
  </head>
  <body>
    <div id="nav">
      <a href="#/page1">page1</a>
      <a href="#/page2">page2</a>
      <a href="#/page3">page3</a>
    </div>
    <div id="container"></div>
    <script>
      (function() {
        class HashRouter {
          constructor() {
            // 用于存储不同hash值对应的回调函数
            this.routers = {};
            window.addEventListener("hashchange", this.load.bind(this), false);
          }
          // 用于注册每个视图
          reqister(hash, callback = function() {}) {
            this.routers[hash] = callback;
          }
          // 用户注册首页
          reqisterIndex(callback = function() {}) {
            this.routers["index"] = callback;
          }
          // 用于调用不同视图的回调函数
          load() {
            let hash = location.hash.slice(1),
              handler;
            if (!hash) {
              handler = this.routers.index;
            } else {
              handler = this.routers[hash];
            }
            //执行注册的回调函数
            handler.call(this);
          }
        }

        let router = new HashRouter();
        let container = document.querySelector("#container");

        // 注册首页回调函数
        router.reqisterIndex(() => (container.innerHTML = "我是首页"));

        // 注册其他视图回调函数
        router.reqister("/page1", () => (container.innerHTML = "我是page1"));
        router.reqister("/page2", () => (container.innerHTML = "我是page2"));
        router.reqister("/page3", () => (container.innerHTML = "我是page3"));

        // 加载视图
        router.load();
      })();
    </script>
  </body>
</html>
